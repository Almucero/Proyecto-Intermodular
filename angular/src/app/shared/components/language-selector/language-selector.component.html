<div class="relative">
  <button
    (click)="toggleLangMenu(); $event.stopPropagation()"
    class="flex items-center gap-1.5 p-0 bg-transparent border-none outline-none hover:opacity-80 focus:outline-none cursor-pointer active:scale-95 transition-transform duration-150"
    [title]="'tooltips.languageSelector' | translate"
  >
    <svg
      xmlns="http://www.w3.org/2000/svg"
      class="h-4 w-4 text-white transition-transform duration-300 pointer-events-none"
      [class.rotate-180]="isLangMenuOpen"
      fill="none"
      viewBox="0 0 24 24"
      stroke="currentColor"
      stroke-width="2"
    >
      <path stroke-linecap="round" stroke-linejoin="round" d="M19 9l-7 7-7-7" />
    </svg>
    <img
      [src]="currentFlag"
      alt="Language"
      class="w-9 h-9 pointer-events-none transition-opacity duration-150"
      [class.opacity-0]="flagIsChanging"
    />
  </button>
  <div
    *ngIf="isLangMenuOpen"
    class="absolute top-full right-0 -mr-1 mt-2 min-w-[3rem] rounded-md shadow-xl overflow-hidden z-50 border-gray-800"
    [class.animate-slideDown]="!isClosing"
    [class.animate-slideUp]="isClosing"
    style="background-color: #030712"
  >
    <div class="flex flex-col items-center py-1">
      <button
        *ngFor="let lang of availableLanguages"
        (click)="setLanguage(lang.code)"
        class="p-1.5 hover:bg-gray-800 w-full flex justify-center bg-transparent border-none transition-transform duration-150 active:scale-95"
        [title]="lang.name"
      >
        <img [src]="lang.flag" [alt]="lang.name" class="w-6 h-6 rounded-sm" />
      </button>
    </div>
  </div>
</div>
